<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GIP Framework: testsuite/tests/Camera1394.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GIP Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">testsuite/tests/Camera1394.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/***************************************************************************</span></div>
<div class="line"><span class="comment">    Generic Image Processing (GIP) Framework (Test Suite)</span></div>
<div class="line"><span class="comment">    A framework for developing image processing applications</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    See COPYRIGHT.txt for details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    This framework is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    For the licensing terms refer to the file &#39;LICENSE&#39;.</span></div>
<div class="line"><span class="comment"> ***************************************************************************/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;gip/Pixel.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;gip/video/Camera1394.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;gip/transformation/Flip.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;gip/YCbCrPixel.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;base/Application.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;base/string/FormatOutputStream.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;base/string/InvalidFormat.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;base/concurrency/Thread.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;base/Timer.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;gip/ArrayImage.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;gip/io/BMPEncoder.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;gip/transformation/Convert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;base/Cast.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>com::azure::dev::gip;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>RGB24ToRGB : <span class="keyword">public</span> UnaryOperation&lt;Camera1394::RGB24Pixel, ColorPixel&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">inline</span> RGB24ToRGB() noexcept {</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">inline</span> Result operator()(<span class="keyword">const</span> Argument&amp; value) <span class="keyword">const</span> noexcept {</div>
<div class="line">    <span class="keywordflow">return</span> makeColorPixel(value.red, value.blue, value.green);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Camera1394Application : <span class="keyword">public</span> Application {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MAJOR_VERSION = 1;</div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MINOR_VERSION = 0;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> Command {</div>
<div class="line">    COMMAND_LIST_ADAPTERS,</div>
<div class="line">    COMMAND_LIST_CAMERAS,</div>
<div class="line">    COMMAND_DUMP,</div>
<div class="line">    COMMAND_RESET,</div>
<div class="line">    COMMAND_REGISTER_SPACE,</div>
<div class="line">    COMMAND_HELP,</div>
<div class="line">    COMMAND_ERROR</div>
<div class="line">  };</div>
<div class="line">  </div>
<div class="line">  Camera1394Application() noexcept</div>
<div class="line">    : Application(MESSAGE(&quot;Camera1394&quot;)) {</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> listAdapters() noexcept {</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">      IEEE1394 ieee1394;</div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Adapters: &quot;</span>) &lt;&lt; ieee1394.getAdapters() &lt;&lt; ENDL;</div>
<div class="line">    } <span class="keywordflow">catch</span> (Exception&amp;) {</div>
<div class="line">      fout &lt;&lt; ENDL;</div>
<div class="line">      ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Unable to list adapters&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">      Application::getApplication()-&gt;setExitCode(EXIT_CODE_ERROR);</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> openAdapter(IEEE1394&amp; ieee1394, <span class="keyword">const</span> EUI64&amp; <span class="keywordtype">id</span>) noexcept {</div>
<div class="line">    fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Opening IEEE 1394 adapter (&quot;</span>) &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="charliteral">&#39;)&#39;</span> &lt;&lt; ENDL;</div>
<div class="line">    ieee1394.open(<span class="keywordtype">id</span>);</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">void</span> dumpNodes(IEEE1394&amp; ieee1394) noexcept {</div>
<div class="line">    fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Available nodes: &quot;</span>) &lt;&lt; EOL;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> node = 0; node &lt; ieee1394.getNumberOfNodes(); ++node) {</div>
<div class="line">      <span class="keywordflow">try</span> {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Node: &quot;</span>) &lt;&lt; ieee1394.getIdentifier(node) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Physical id: &quot;</span>) &lt;&lt; node &lt;&lt; ENDL;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vendor = ieee1394.getVendorId(node);</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Vendor id: &quot;</span>)</div>
<div class="line">             &lt;&lt; HEX &lt;&lt; setWidth(2) &lt;&lt; ZEROPAD &lt;&lt; NOPREFIX &lt;&lt; ((vendor &gt;&gt; 16) &amp; 0xff) &lt;&lt; <span class="charliteral">&#39;:&#39;</span></div>
<div class="line">             &lt;&lt; HEX &lt;&lt; setWidth(2) &lt;&lt; ZEROPAD &lt;&lt; NOPREFIX &lt;&lt; ((vendor &gt;&gt; 8) &amp; 0xff) &lt;&lt; <span class="charliteral">&#39;:&#39;</span></div>
<div class="line">             &lt;&lt; HEX &lt;&lt; setWidth(2) &lt;&lt; ZEROPAD &lt;&lt; NOPREFIX &lt;&lt; (vendor &amp; 0xff) &lt;&lt; ENDL;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> capabilities = ieee1394.getCapabilities(node);</div>
<div class="line">        <span class="keywordflow">if</span> (capabilities) {</div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Capabilities:&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">          <span class="keywordflow">if</span> (capabilities &amp; IEEE1394::ISOCHRONOUS_RESOURCE_MANAGER_CAPABLE) {</div>
<div class="line">            fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    Isochronous resource manager&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (capabilities &amp; IEEE1394::CYCLE_MASTER_CAPABLE) {</div>
<div class="line">            fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    Cycle master&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (capabilities &amp; IEEE1394::ISOCHRONOUS_TRANSACTION_CAPABLE) {</div>
<div class="line">            fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    Isochronous transmission&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (capabilities &amp; IEEE1394::BUS_MASTER_CAPABLE) {</div>
<div class="line">            fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    Bus master&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (capabilities &amp; IEEE1394::POWER_MANAGER_CAPABLE) {</div>
<div class="line">            fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    Power manager&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Maximum asynchronous payload: &quot;</span>) &lt;&lt; ieee1394.getMaximumPayload(node) &lt;&lt; ENDL;</div>
<div class="line">      } <span class="keywordflow">catch</span> (IEEE1394Exception&amp; e) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Exception: &quot;</span>) &lt;&lt; e &lt;&lt; ENDL;</div>
<div class="line">        <span class="comment">// check cause</span></div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    fout &lt;&lt; EOL &lt;&lt; ENDL;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">void</span> listCameras() noexcept {</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">      IEEE1394 ieee1394;</div>
<div class="line"> </div>
<div class="line">      Array&lt;EUI64&gt; adapters = ieee1394.getAdapters();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (adapters.getSize() == 0) {</div>
<div class="line">        ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;No adapters available&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      openAdapter(ieee1394, adapters[0]);</div>
<div class="line">      dumpNodes(ieee1394);</div>
<div class="line">      </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Closing IEEE 1394 adapter&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">      ieee1394.close();</div>
<div class="line">    } <span class="keywordflow">catch</span> (Exception&amp; e) {</div>
<div class="line">      fout &lt;&lt; ENDL;</div>
<div class="line">      ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Unable to list adapters: &quot;</span>) &lt;&lt; e &lt;&lt; ENDL;</div>
<div class="line">      Application::getApplication()-&gt;setExitCode(EXIT_CODE_ERROR);</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> dumpFeatureInquery(<span class="keyword">const</span> String&amp; feature, <span class="keyword">const</span> Camera1394::GenericFeatureDescriptor&amp; descriptor) <span class="keyword">const</span> noexcept {</div>
<div class="line">    fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature: &quot;</span>) &lt;&lt; feature &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Available: &quot;</span>) &lt;&lt; descriptor.available &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Automatic adjustment mode: &quot;</span>) &lt;&lt; descriptor.autoAdjustmentMode &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Readable: &quot;</span>) &lt;&lt; descriptor.readable &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Switchable: &quot;</span>) &lt;&lt; descriptor.switchable &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Automatic mode: &quot;</span>) &lt;&lt; descriptor.automaticMode &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Manual mode: &quot;</span>) &lt;&lt; descriptor.manualMode &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Minimume value: &quot;</span>) &lt;&lt; descriptor.minimum &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Maximum value: &quot;</span>) &lt;&lt; descriptor.maximum &lt;&lt; ENDL;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">void</span> dumpTriggerFeatureInquery(<span class="keyword">const</span> String&amp; feature, <span class="keyword">const</span> Camera1394::TriggerFeatureDescriptor&amp; descriptor) <span class="keyword">const</span> noexcept {</div>
<div class="line">    fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature: &quot;</span>) &lt;&lt; feature &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Available: &quot;</span>) &lt;&lt; descriptor.available &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Readable: &quot;</span>) &lt;&lt; descriptor.readable &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Switchable: &quot;</span>) &lt;&lt; descriptor.switchable &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Polarity: &quot;</span>) &lt;&lt; descriptor.polarity &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Signals: &quot;</span>) &lt;&lt; HEX &lt;&lt; setWidth(10) &lt;&lt; ZEROPAD &lt;&lt; descriptor.availableSignals &lt;&lt; ENDL;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">void</span> dump() noexcept {</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> Literal PIXEL_FORMAT_DESCRIPTION[] = {</div>
<div class="line">      MESSAGE(<span class="stringliteral">&quot;Mono 8bit/pixel&quot;</span>),</div>
<div class="line">      MESSAGE(<span class="stringliteral">&quot;Mono 16bit/pixel&quot;</span>),</div>
<div class="line">      MESSAGE(<span class="stringliteral">&quot;YUV 4:1:1 12bit/pixel&quot;</span>),</div>
<div class="line">      MESSAGE(<span class="stringliteral">&quot;YUV 4:2:2 16bit/pixel&quot;</span>),</div>
<div class="line">      MESSAGE(<span class="stringliteral">&quot;YUV 4:4:4 24bit/pixel&quot;</span>),</div>
<div class="line">      MESSAGE(<span class="stringliteral">&quot;RGB 24bit/pixel&quot;</span>),</div>
<div class="line">      MESSAGE(<span class="stringliteral">&quot;RGB 48bit/pixel&quot;</span>)</div>
<div class="line">    };</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">      IEEE1394 ieee1394;</div>
<div class="line"> </div>
<div class="line">      Array&lt;EUI64&gt; adapters = ieee1394.getAdapters();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (adapters.getSize() == 0) {</div>
<div class="line">        ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;No adapters available&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      <span class="comment">// TAG: get bus id&#39;s, get nodes for specific bus, is bus present methods?</span></div>
<div class="line">      openAdapter(ieee1394, adapters[0]);</div>
<div class="line">      dumpNodes(ieee1394);</div>
<div class="line">      </div>
<div class="line">      Camera1394 camera;</div>
<div class="line">      EUI64 cameraGuid;</div>
<div class="line">      </div>
<div class="line">      {</div>
<div class="line">        Array&lt;EUI64&gt; cameras = camera.getCameras();</div>
<div class="line">        <span class="keywordflow">if</span> (cameras.getSize() == 0) {</div>
<div class="line">          ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;No cameras available&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">          <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">        Array&lt;EUI64&gt;::ReadEnumerator enu = cameras.getReadEnumerator();</div>
<div class="line">        <span class="keywordflow">while</span> (enu.hasNext()) {</div>
<div class="line">          <span class="keyword">const</span> EUI64* guid = enu.next();</div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Camera &quot;</span>) &lt;&lt; i &lt;&lt; MESSAGE(<span class="stringliteral">&quot;: &quot;</span>) &lt;&lt; *guid &lt;&lt; ENDL;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        cameraGuid = cameras[0];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Status: &quot;</span>) &lt;&lt; ieee1394.getStatus() &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Opening camera: &quot;</span>) &lt;&lt; cameraGuid &lt;&lt; ENDL;</div>
<div class="line">      camera.open(cameraGuid);</div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> specification = camera.getSpecification();</div>
<div class="line">      </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Vendor: &quot;</span>) &lt;&lt; camera.getVendorName() &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Model: &quot;</span>) &lt;&lt; camera.getModelName() &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Specification: &quot;</span>) &lt;&lt; ((specification &gt;&gt; 16) &amp; 0xff) &lt;&lt; <span class="charliteral">&#39;.&#39;</span> &lt;&lt; ((specification &gt;&gt; 8) &amp; 0xff) &lt;&lt; ENDL;</div>
<div class="line">      </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Register base address: &quot;</span>) &lt;&lt; HEX &lt;&lt; camera.getCommandRegisters() &lt;&lt; ENDL; <span class="comment">// TAG: only done</span></div>
<div class="line">      </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> capabilities = camera.getCapabilities();</div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Capabilities:&quot;</span>);</div>
<div class="line">      <span class="keywordflow">if</span> (capabilities &amp; Camera1394::POWER_CONTROL) {</div>
<div class="line">        fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;POWER&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (capabilities &amp; Camera1394::SINGLE_ACQUISITION) {</div>
<div class="line">        fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;SINGLE-SHOT&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (capabilities &amp; Camera1394::MULTI_ACQUISITION) {</div>
<div class="line">        fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;MULTI-SHOT&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (capabilities &amp; Camera1394::ADVANCED_FEATURES) {</div>
<div class="line">        fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;ADVANCED&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (capabilities &amp; Camera1394::MODE_ERROR_STATUS) {</div>
<div class="line">        fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;MODE-STATUS&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (capabilities &amp; Camera1394::FEATURE_ERROR_STATUS) {</div>
<div class="line">        fout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; MESSAGE(<span class="stringliteral">&quot;FEATURE-STATUS&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      fout &lt;&lt; EOL &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Power: &quot;</span>) &lt;&lt; camera.isUpAndRunning() &lt;&lt; ENDL;</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">if</span> (capabilities &amp; Camera1394::ADVANCED_FEATURES) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Advanced feature address: &quot;</span>) &lt;&lt; HEX &lt;&lt; setWidth(18) &lt;&lt; ZEROPAD &lt;&lt; camera.getAdvancedFeatureAddress() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      camera.reset();</div>
<div class="line">      Thread::millisleep(100);</div>
<div class="line">      </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Supported formats:&quot;</span>) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Uncompressed VGA: &quot;</span>) &lt;&lt; camera.isFormatSupported(Camera1394::UNCOMPRESSED_VGA) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Uncompressed Super VGA I: &quot;</span>) &lt;&lt; camera.isFormatSupported(Camera1394::UNCOMPRESSED_SUPER_VGA_I) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Uncompressed Super VGA II: &quot;</span>) &lt;&lt; camera.isFormatSupported(Camera1394::UNCOMPRESSED_SUPER_VGA_II) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Still image: &quot;</span>) &lt;&lt; camera.isFormatSupported(Camera1394::STILL_IMAGE) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Partial image: &quot;</span>) &lt;&lt; camera.isFormatSupported(Camera1394::PARTIAL_IMAGE) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; EOL &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Modes: &quot;</span>) &lt;&lt; EOL;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; getArraySize(Camera1394::MODES); ++i) {</div>
<div class="line">        Camera1394::Mode mode = Camera1394::MODES[i];</div>
<div class="line">        <span class="keywordflow">if</span> (camera.isModeSupported(mode)) {</div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Mode: &quot;</span>) &lt;&lt; camera.getModeAsString(mode) &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  maximum dimension: &quot;</span>) &lt;&lt; camera.getMaximumDimension(mode) &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  unit dimension: &quot;</span>) &lt;&lt; camera.getUnitDimension(mode) &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  unit offset: &quot;</span>) &lt;&lt; camera.getUnitOffset(mode) &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  frame rate(s): &quot;</span>);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> frameRates = camera.getFrameRates(mode);</div>
<div class="line">          <span class="keywordflow">if</span> (frameRates != 0) {</div>
<div class="line">            fout &lt;&lt; EOL;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rate = Camera1394::RATE_1_875; rate &lt;= Camera1394::RATE_60; ++rate) {</div>
<div class="line">              <span class="keywordflow">if</span> ((frameRates &gt;&gt; rate) &amp; 1) {</div>
<div class="line">                fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    &quot;</span>) &lt;&lt; Camera1394::getFrameRateAsValue(<span class="keyword">static_cast&lt;</span>Camera1394::FrameRate<span class="keyword">&gt;</span>(rate))/65536.0 &lt;&lt; MESSAGE(<span class="stringliteral">&quot; frames/second&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">              }</div>
<div class="line">            }      </div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;unspecified&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">          }</div>
<div class="line">          </div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  pixel format(s): &quot;</span>);</div>
<div class="line">          </div>
<div class="line">          <span class="keyword">static</span> <span class="keyword">const</span> Camera1394::PixelFormat PIXEL_FORMAT[] = {</div>
<div class="line">            Camera1394::Y_8BIT,</div>
<div class="line">            Camera1394::Y_16BIT,</div>
<div class="line">            Camera1394::YUV_411_8BIT,</div>
<div class="line">            Camera1394::YUV_422_8BIT,</div>
<div class="line">            Camera1394::YUV_444_8BIT,</div>
<div class="line">            Camera1394::RGB_8BIT,</div>
<div class="line">            Camera1394::RGB_16BIT</div>
<div class="line">          };</div>
<div class="line">          </div>
<div class="line">          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pixelFormats = camera.getPixelFormats(mode);</div>
<div class="line">          <span class="keywordflow">if</span> (Math::isPowerOf2(pixelFormats)) {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; getArraySize(PIXEL_FORMAT); ++i) {</div>
<div class="line">              <span class="keywordflow">if</span> (pixelFormats &amp; (1 &lt;&lt; PIXEL_FORMAT[i])) {</div>
<div class="line">                fout &lt;&lt; PIXEL_FORMAT_DESCRIPTION[i] &lt;&lt; EOL;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            fout &lt;&lt; EOL;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; getArraySize(PIXEL_FORMAT); ++i) {</div>
<div class="line">              <span class="keywordflow">if</span> (pixelFormats &amp; (1 &lt;&lt; PIXEL_FORMAT[i])) {</div>
<div class="line">                fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    &quot;</span>) &lt;&lt; i &lt;&lt; <span class="charliteral">&#39;.&#39;</span> &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; PIXEL_FORMAT_DESCRIPTION[i] &lt;&lt; EOL;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">          fout &lt;&lt; FLUSH;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Mode: &quot;</span>) &lt;&lt; camera.getModeAsString(mode) &lt;&lt; MESSAGE(<span class="stringliteral">&quot; (NOT SUPPORTED)&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      fout &lt;&lt; EOL &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//      camera.setMode(Camera1394::PARTIAL_IMAGE_MODE_1);</span></div>
<div class="line"><span class="comment">//      camera.setMode(Camera1394::PARTIAL_IMAGE_MODE_0);</span></div>
<div class="line"><span class="comment">//      camera.setMode(Camera1394::Y_1024X768_8BIT);</span></div>
<div class="line"><span class="comment">//      camera.setMode(Camera1394::Y_640X480_8BIT);</span></div>
<div class="line"><span class="comment">//      camera.setMode(Camera1394::RGB_640X480_24BIT);</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//       Region region = camera.getRegion();</span></div>
<div class="line"><span class="comment">//       region.setDimension(Dimension(762, 500));</span></div>
<div class="line"><span class="comment">//       camera.setRegion(region);</span></div>
<div class="line">      </div>
<div class="line">      <span class="keyword">const</span> Camera1394::IsochronousTransmission&amp; transmission = camera.getTransmission();</div>
<div class="line">      </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Current mode: &quot;</span>) &lt;&lt; camera.getModeAsString(camera.getMode()) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Frame rate: &quot;</span>) &lt;&lt; Camera1394::getFrameRateAsValue(camera.getFrameRate())/65536.0 &lt;&lt; MESSAGE(<span class="stringliteral">&quot; frames/second&quot;</span>) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Pixel format: &quot;</span>) &lt;&lt; PIXEL_FORMAT_DESCRIPTION[camera.getPixelFormat()] &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Region: &quot;</span>) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    Dimension: &quot;</span>) &lt;&lt; camera.getRegion().getDimension() &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    Offset: &quot;</span>) &lt;&lt; camera.getRegion().getOffset() &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Isochronous transmission: &quot;</span>) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    pixelsPerFrame: &quot;</span>) &lt;&lt; transmission.pixelsPerFrame &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    totalBytesPerFrame: &quot;</span>) &lt;&lt; transmission.totalBytesPerFrame &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    unitBytesPerPacket: &quot;</span>) &lt;&lt; transmission.unitBytesPerPacket &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    maximumBytesPerPacket: &quot;</span>) &lt;&lt; transmission.maximumBytesPerPacket &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    bytesPerPacket: &quot;</span>) &lt;&lt; transmission.bytesPerPacket &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    recommendedBytesPerPacket: &quot;</span>) &lt;&lt; transmission.recommendedBytesPerPacket &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;    packetsPerFrame: &quot;</span>) &lt;&lt; transmission.packetsPerFrame &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; EOL &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Isochronous channel: &quot;</span>) &lt;&lt; camera.getIsochronousChannel() &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Isochronous speed: &quot;</span>) &lt;&lt; camera.getIsochronousSpeed() &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line">      </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Supported features:&quot;</span>) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Brightness: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::BRIGHTNESS_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Auto exposure: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::AUTO_EXPOSURE_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  White balance: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::WHITE_BALANCE_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Hue: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::HUE_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Saturation: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::SATURATION_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Gamma: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::GAMMA_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Shutter: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::SHUTTER_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Gain: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::GAIN_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  IRIS: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::IRIS_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Focus: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::FOCUS_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Temperature: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::TEMPERATURE_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Trigger: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::TRIGGER_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Zoom: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::ZOOM_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Pan: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::PAN_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Tilt: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::TILT_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Optical filter: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::OPTICAL_FILTER_CONTROL) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Capture size: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::CAPTURE_SIZE) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Capture quality: &quot;</span>) &lt;&lt; camera.isFeatureSupported(Camera1394::CAPTURE_QUALITY) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; EOL &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::BRIGHTNESS_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Brightness&quot;</span>), camera.getFeatureDescriptor(Camera1394::BRIGHTNESS_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::AUTO_EXPOSURE_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Auto exposure&quot;</span>), camera.getFeatureDescriptor(Camera1394::AUTO_EXPOSURE_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::SHARPNESS_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Sharpness&quot;</span>), camera.getFeatureDescriptor(Camera1394::SHARPNESS_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::WHITE_BALANCE_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;White balance&quot;</span>), camera.getFeatureDescriptor(Camera1394::WHITE_BALANCE_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::HUE_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Hue&quot;</span>), camera.getFeatureDescriptor(Camera1394::HUE_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::SATURATION_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Saturation&quot;</span>), camera.getFeatureDescriptor(Camera1394::SATURATION_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::GAMMA_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Gamma&quot;</span>), camera.getFeatureDescriptor(Camera1394::GAMMA_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::SHUTTER_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Shutter&quot;</span>), camera.getFeatureDescriptor(Camera1394::SHUTTER_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::GAIN_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Gain&quot;</span>), camera.getFeatureDescriptor(Camera1394::GAIN_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::IRIS_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;IRIS&quot;</span>), camera.getFeatureDescriptor(Camera1394::IRIS_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::FOCUS_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Focus&quot;</span>), camera.getFeatureDescriptor(Camera1394::FOCUS_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::TEMPERATURE_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Temperature&quot;</span>), camera.getFeatureDescriptor(Camera1394::TEMPERATURE_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::TRIGGER_CONTROL)) {</div>
<div class="line">        dumpTriggerFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Trigger&quot;</span>), camera.getTriggerFeatureDescriptor());</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::ZOOM_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Zoom&quot;</span>), camera.getFeatureDescriptor(Camera1394::ZOOM_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::PAN_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Pan&quot;</span>), camera.getFeatureDescriptor(Camera1394::PAN_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::TILT_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Tilt&quot;</span>), camera.getFeatureDescriptor(Camera1394::TILT_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::OPTICAL_FILTER_CONTROL)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Optical filter&quot;</span>), camera.getFeatureDescriptor(Camera1394::OPTICAL_FILTER_CONTROL));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::CAPTURE_SIZE)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Capture size&quot;</span>), camera.getFeatureDescriptor(Camera1394::CAPTURE_SIZE));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureSupported(Camera1394::CAPTURE_QUALITY)) {</div>
<div class="line">        dumpFeatureInquery(MESSAGE(<span class="stringliteral">&quot;Capture quality&quot;</span>), camera.getFeatureDescriptor(Camera1394::CAPTURE_QUALITY));</div>
<div class="line">      }</div>
<div class="line">      fout &lt;&lt; EOL &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">static</span> <span class="keyword">const</span> Literal OPERATING_MODES[] = {</div>
<div class="line">        MESSAGE(<span class="stringliteral">&quot;disabled&quot;</span>), MESSAGE(<span class="stringliteral">&quot;automatic&quot;</span>), MESSAGE(<span class="stringliteral">&quot;automatic adjustment&quot;</span>), MESSAGE(<span class="stringliteral">&quot;manual&quot;</span>)</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::BRIGHTNESS_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Brightness&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::BRIGHTNESS_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getBrightness() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::AUTO_EXPOSURE_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Auto exposure&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::AUTO_EXPOSURE_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getAutoExposure() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::SHARPNESS_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Sharpness&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::SHARPNESS_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getSharpness() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::WHITE_BALANCE_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - White balance&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::WHITE_BALANCE_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Cb/blue ratio: &quot;</span>) &lt;&lt; camera.getWhiteBalanceBlueRatio() &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Cr/red ratio: &quot;</span>) &lt;&lt; camera.getWhiteBalanceRedRatio() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::HUE_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Hue&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::HUE_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getHue() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::SATURATION_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Saturation&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::SATURATION_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getSaturation() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::GAMMA_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Gamma&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::GAMMA_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getGamma() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::SHUTTER_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Shutter&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::SHUTTER_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getShutter() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::GAIN_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Gain&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::GAIN_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getGain() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::IRIS_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - IRIS&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::IRIS_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getIRIS() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::FOCUS_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Focus&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::FOCUS_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getFocus() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::TEMPERATURE_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Temperature&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::TEMPERATURE_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Target value: &quot;</span>) &lt;&lt; camera.getTargetTemperature() &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Current value: &quot;</span>) &lt;&lt; camera.getTemperature() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// TAG: need getTrigger...()</span></div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::ZOOM_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Zoom&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::ZOOM_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getZoom() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::PAN_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Pan&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::PAN_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getPan() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::TILT_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Tilt&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::TILT_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getTilt() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::OPTICAL_FILTER_CONTROL)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Optical filter&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::OPTICAL_FILTER_CONTROL)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getOpticalFilter() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::CAPTURE_SIZE)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Capture size&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::CAPTURE_SIZE)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getCaptureSize() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (camera.isFeatureReadable(Camera1394::CAPTURE_QUALITY)) {</div>
<div class="line">        fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Capture quality&quot;</span>) &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Mode: &quot;</span>) &lt;&lt; OPERATING_MODES[camera.getFeatureOperatingMode(Camera1394::CAPTURE_QUALITY)] &lt;&lt; EOL</div>
<div class="line">             &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getCaptureQuality() &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line">      fout &lt;&lt; ENDL;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// if Sony 700...</span></div>
<div class="line">      <span class="keyword">static</span> <span class="keyword">const</span> uint8 BASLER_ID[8] = {0x00, 0x30, 0x53, 0x19, 0x6d, 0x6c, 0x98, 0x8e};</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">if</span> (cameraGuid == EUI64(BASLER_ID)) {</div>
<div class="line">        <span class="keywordflow">if</span> (camera.getFeatureDescriptor(Camera1394::SHUTTER_CONTROL).manualMode) {</div>
<div class="line">          camera.setFeatureOperatingMode(Camera1394::SHUTTER_CONTROL, Camera1394::MANUAL);</div>
<div class="line">          camera.setShutter(1000);</div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Shutter&quot;</span>) &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getShutter() &lt;&lt; ENDL;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (camera.getFeatureDescriptor(Camera1394::GAIN_CONTROL).manualMode) {</div>
<div class="line">          camera.setFeatureOperatingMode(Camera1394::GAIN_CONTROL, Camera1394::MANUAL);</div>
<div class="line">          camera.setGain(175);</div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Gain&quot;</span>) &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getGain() &lt;&lt; ENDL;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (camera.getFeatureDescriptor(Camera1394::BRIGHTNESS_CONTROL).manualMode) {</div>
<div class="line">          camera.setFeatureOperatingMode(Camera1394::BRIGHTNESS_CONTROL, Camera1394::MANUAL);</div>
<div class="line">          camera.setBrightness(80);</div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - Brightness&quot;</span>) &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Value: &quot;</span>) &lt;&lt; camera.getBrightness() &lt;&lt; ENDL;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (camera.getFeatureDescriptor(Camera1394::WHITE_BALANCE_CONTROL).manualMode) {</div>
<div class="line">          camera.setFeatureOperatingMode(Camera1394::WHITE_BALANCE_CONTROL, Camera1394::MANUAL);</div>
<div class="line">          camera.setWhiteBalance(100, 100);</div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Feature state - White balance&quot;</span>) &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Cb/blue: &quot;</span>) &lt;&lt; camera.getWhiteBalanceBlueRatio() &lt;&lt; EOL</div>
<div class="line">               &lt;&lt; MESSAGE(<span class="stringliteral">&quot;  Cr/red: &quot;</span>) &lt;&lt; camera.getWhiteBalanceRedRatio() &lt;&lt; ENDL;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      String filename(MESSAGE(<span class="stringliteral">&quot;frame0.bmp&quot;</span>));</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">switch</span> (camera.getPixelFormat()) {</div>
<div class="line">      <span class="keywordflow">case</span> Camera1394::Y_8BIT:</div>
<div class="line">        {</div>
<div class="line">          ArrayImage&lt;uint8&gt; frame(camera.getRegion().getDimension());</div>
<div class="line">          GrayImage finalImage(frame.getDimension());</div>
<div class="line">          </div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Acquiring frame&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">          <span class="keywordflow">if</span> (!camera.acquire(frame)) {</div>
<div class="line">            ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Unable to acquire frame&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">            setExitCode(EXIT_CODE_ERROR);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          Flip&lt;ArrayImage&lt;uint8&gt; &gt; flip(&amp;frame);</div>
<div class="line">          flip();</div>
<div class="line">          </div>
<div class="line">          Convert&lt;GrayImage, ArrayImage&lt;uint8&gt;, Same&lt;uint8&gt; &gt; convert(&amp;finalImage, &amp;frame, Same&lt;uint8&gt;());</div>
<div class="line">          convert();</div>
<div class="line">          </div>
<div class="line">          BMPEncoder encoder;</div>
<div class="line">          encoder.writeGray(filename, &amp;finalImage);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> Camera1394::RGB_8BIT:</div>
<div class="line">        {</div>
<div class="line">          ArrayImage&lt;Camera1394::RGB24Pixel&gt; frame(camera.getRegion().getDimension());</div>
<div class="line">          ColorImage finalImage(frame.getDimension());</div>
<div class="line">        </div>
<div class="line">          Timer timer;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 128; ++i) {</div>
<div class="line">            fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Acquiring frame: &quot;</span>) &lt;&lt; timer.getLiveMicroseconds() &lt;&lt; ENDL;</div>
<div class="line">            camera.acquire(frame);</div>
<div class="line">          }</div>
<div class="line">          </div>
<div class="line">          Flip&lt;ArrayImage&lt;Camera1394::RGB24Pixel&gt; &gt; flip(&amp;frame);</div>
<div class="line">          flip();</div>
<div class="line">          </div>
<div class="line">          Convert&lt;ColorImage, ArrayImage&lt;Camera1394::RGB24Pixel&gt;, RGB24ToRGB&gt; convert(&amp;finalImage, &amp;frame, RGB24ToRGB());</div>
<div class="line">          convert();</div>
<div class="line">          </div>
<div class="line">          BMPEncoder encoder;</div>
<div class="line">          encoder.write(filename, &amp;finalImage);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> Camera1394::Y_16BIT:</div>
<div class="line">        {</div>
<div class="line">          ArrayImage&lt;uint16&gt; frame(camera.getRegion().getDimension());</div>
<div class="line">          ColorImage finalImage(frame.getDimension());</div>
<div class="line">          </div>
<div class="line">          fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Acquiring frame&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">          <span class="keywordflow">if</span> (!camera.acquire(frame)) {</div>
<div class="line">            ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Unable to acquire frame&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">            setExitCode(EXIT_CODE_ERROR);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          Flip&lt;ArrayImage&lt;uint16&gt; &gt; flip(&amp;frame);</div>
<div class="line">          flip();</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// TAG: fixme - uint16 to ColorPixel</span></div>
<div class="line">          <span class="comment">//Convert&lt;ColorImage, ArrayImage&lt;uint16&gt;, Same&lt;uint16&gt; &gt; convert(&amp;finalImage, &amp;frame, Same&lt;uint16&gt;());</span></div>
<div class="line">          <span class="comment">//convert();</span></div>
<div class="line">          </div>
<div class="line">          BMPEncoder encoder;</div>
<div class="line">          encoder.write(filename, &amp;finalImage);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> Camera1394::YUV_422_8BIT:</div>
<div class="line">        {</div>
<div class="line">          Allocator&lt;uint8&gt; frame(camera.getRegion().getDimension().getSize() * 2); <span class="comment">// 16 effective bits per pixel</span></div>
<div class="line">          ColorImage finalImage(camera.getRegion().getDimension());</div>
<div class="line">          </div>
<div class="line">          camera.acquire(frame.getElements(), frame.getSize());</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">const</span> uint8* src = frame.getElements();</div>
<div class="line">          </div>
<div class="line">          ColorImage::Rows rowLookup = finalImage.getRows();</div>
<div class="line">          ColorImage::Rows::RowIterator row = rowLookup.getFirst();</div>
<div class="line">          <span class="keyword">const</span> ColorImage::Rows::RowIterator endRow = rowLookup.getEnd();</div>
<div class="line">          <span class="keywordflow">while</span> (row &lt; endRow) {</div>
<div class="line">            ColorImage::Rows::RowIterator::ElementIterator column = row.getFirst();</div>
<div class="line">            <span class="keyword">const</span> ColorImage::Rows::RowIterator::ElementIterator endColumn = row.getEnd();</div>
<div class="line">            <span class="keywordflow">while</span> (column &lt; endColumn) {</div>
<div class="line">              uint8 Cb = *src++;</div>
<div class="line">              uint8 Y0 = *src++;</div>
<div class="line">              uint8 Cr = *src++;</div>
<div class="line">              uint8 Y1 = *src++;</div>
<div class="line">              *column++ = <a class="code" href="namespacegip.html#ae4332c394042e65826527a09616032d2">YCbCrToRGB</a>(<a class="code" href="namespacegip.html#af07bb1ceb47affe5d873cdb8e4b7241a">makeYCbCrPixel</a>(Y0, Cb, Cr));</div>
<div class="line">              *column++ = <a class="code" href="namespacegip.html#ae4332c394042e65826527a09616032d2">YCbCrToRGB</a>(<a class="code" href="namespacegip.html#af07bb1ceb47affe5d873cdb8e4b7241a">makeYCbCrPixel</a>(Y1, Cb, Cr));</div>
<div class="line">            }</div>
<div class="line">            ++row;</div>
<div class="line">          }</div>
<div class="line">          </div>
<div class="line">          Flip&lt;ColorImage&gt; flip(&amp;finalImage); <span class="comment">// TAG: should be handled by YUV 422 to RGB conversion</span></div>
<div class="line">          flip();</div>
<div class="line">          </div>
<div class="line">          BMPEncoder encoder;</div>
<div class="line">          encoder.write(filename, &amp;finalImage);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> Camera1394::YUV_411_8BIT:</div>
<div class="line">      <span class="keywordflow">case</span> Camera1394::YUV_444_8BIT:</div>
<div class="line">      <span class="keywordflow">case</span> Camera1394::RGB_16BIT:</div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Pixel format is not supported&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Closing IEEE 1394 adapter&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">      ieee1394.close();</div>
<div class="line">    } <span class="keywordflow">catch</span> (Exception&amp; e) {</div>
<div class="line">      fout &lt;&lt; ENDL;</div>
<div class="line">      ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Unable to get device information: &quot;</span>) &lt;&lt; e &lt;&lt; ENDL;</div>
<div class="line">      Application::getApplication()-&gt;setExitCode(EXIT_CODE_ERROR);</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> dumpRegisterSpace(uint64 firstAddress, uint64 lastAddress <span class="comment">/*, EUI64 guid*/</span>) noexcept {</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">      IEEE1394 ieee1394;</div>
<div class="line"> </div>
<div class="line">      Array&lt;EUI64&gt; adapters = ieee1394.getAdapters();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (adapters.getSize() == 0) {</div>
<div class="line">        ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;No adapters available&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      openAdapter(ieee1394, adapters[0]);</div>
<div class="line">      </div>
<div class="line"><span class="comment">//       Camera1394 camera;</span></div>
<div class="line"><span class="comment">//       Array&lt;EUI64&gt; cameras = camera.getCameras();</span></div>
<div class="line"><span class="comment">//       if (cameras.getSize() == 0) {</span></div>
<div class="line"><span class="comment">//         ferr &lt;&lt; MESSAGE(&quot;No cameras available&quot;) &lt;&lt; ENDL;</span></div>
<div class="line"><span class="comment">//         return;</span></div>
<div class="line"><span class="comment">//       }</span></div>
<div class="line">      </div>
<div class="line"><span class="comment">//       unsigned int i = 0;</span></div>
<div class="line"><span class="comment">//       Array&lt;EUI64&gt;::ReadEnumerator enu = cameras.getReadEnumerator();</span></div>
<div class="line"><span class="comment">//       while (enu.hasNext()) {</span></div>
<div class="line"><span class="comment">//         const EUI64* guid = enu.next();</span></div>
<div class="line"><span class="comment">//         fout &lt;&lt; MESSAGE(&quot;Camera &quot;) &lt;&lt; i &lt;&lt; MESSAGE(&quot;: &quot;) &lt;&lt; *guid &lt;&lt; ENDL;</span></div>
<div class="line"><span class="comment">//       }</span></div>
<div class="line">      </div>
<div class="line"><span class="comment">//       fout &lt;&lt; MESSAGE(&quot;Opening camera: &quot;) &lt;&lt; cameras[0] &lt;&lt; ENDL;</span></div>
<div class="line"><span class="comment">//       camera.open(cameras[0]);</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//      const unsigned int node = ieee1394.getPhysicalId(cameras[0]);</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> node = 0;</div>
<div class="line">      </div>
<div class="line">      <span class="keyword">const</span> uint32 DEFAULT_VALUE = 0xdccd2332;</div>
<div class="line">      <span class="keyword">const</span> uint64 endAddress = lastAddress + <span class="keyword">sizeof</span>(uint32);</div>
<div class="line">      </div>
<div class="line">      uint32 buffer[4096];</div>
<div class="line">      <span class="keywordflow">while</span> (firstAddress &lt; endAddress) {</div>
<div class="line">        uint32 bytesToRead = endAddress - firstAddress;</div>
<div class="line">        <span class="keywordflow">if</span> (bytesToRead &gt; getArraySize(buffer) * <span class="keyword">sizeof</span>(uint32)) {</div>
<div class="line">          bytesToRead = getArraySize(buffer) * <span class="keyword">sizeof</span>(uint32);</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        ieee1394.read(node, firstAddress, buffer, bytesToRead/<span class="keyword">sizeof</span>(uint32), DEFAULT_VALUE);</div>
<div class="line">        <span class="comment">// TAG: could read twice with difference default values</span></div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; bytesToRead/<span class="keyword">sizeof</span>(uint32); ++i) {</div>
<div class="line">          <span class="keywordflow">if</span> (buffer[i] != DEFAULT_VALUE) {</div>
<div class="line">            fout &lt;&lt; HEX &lt;&lt; setWidth(16) &lt;&lt; ZEROPAD &lt;&lt; NOPREFIX &lt;&lt; (firstAddress + i * <span class="keyword">sizeof</span>(uint32)) &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <span class="charliteral">&#39; &#39;</span></div>
<div class="line">                 &lt;&lt; HEX &lt;&lt; setWidth(8) &lt;&lt; ZEROPAD &lt;&lt; NOPREFIX &lt;&lt; buffer[i] &lt;&lt; EOL;</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            fout &lt;&lt; HEX &lt;&lt; setWidth(16) &lt;&lt; ZEROPAD &lt;&lt; NOPREFIX &lt;&lt; (firstAddress + i * <span class="keyword">sizeof</span>(uint32)) &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <span class="charliteral">&#39; &#39;</span></div>
<div class="line">                 &lt;&lt; MESSAGE(<span class="stringliteral">&quot;........&quot;</span>) &lt;&lt; EOL;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        firstAddress += bytesToRead;</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">catch</span> (Exception&amp; e) {</div>
<div class="line">      fout &lt;&lt; ENDL;</div>
<div class="line">      ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Exception: &quot;</span>) &lt;&lt; e &lt;&lt; ENDL;</div>
<div class="line">      Application::getApplication()-&gt;setExitCode(EXIT_CODE_ERROR);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">void</span> main() noexcept {</div>
<div class="line">    fout &lt;&lt; getFormalName() &lt;&lt; MESSAGE(<span class="stringliteral">&quot; version &quot;</span>) &lt;&lt; MAJOR_VERSION &lt;&lt; <span class="charliteral">&#39;.&#39;</span> &lt;&lt; MINOR_VERSION &lt;&lt; EOL</div>
<div class="line">         &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Generic Image Processing Framework (Test Suite)&quot;</span>) &lt;&lt; EOL &lt;&lt; ENDL;</div>
<div class="line">    </div>
<div class="line">    Command command = COMMAND_ERROR;</div>
<div class="line">    String guid;</div>
<div class="line">    uint64 firstAddress;</div>
<div class="line">    uint64 lastAddress;</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">const</span> Array&lt;String&gt; arguments = getArguments();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (arguments.getSize() == 1) {</div>
<div class="line">      <span class="keywordflow">if</span> (arguments[0] == <span class="stringliteral">&quot;help&quot;</span>) {</div>
<div class="line">        command = COMMAND_HELP;</div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (arguments[0] == <span class="stringliteral">&quot;adapters&quot;</span>) {</div>
<div class="line">        command = COMMAND_LIST_ADAPTERS;</div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (arguments[0] == <span class="stringliteral">&quot;cameras&quot;</span>) {</div>
<div class="line">        command = COMMAND_LIST_CAMERAS;</div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (arguments[0] == <span class="stringliteral">&quot;dump&quot;</span>) {</div>
<div class="line">        command = COMMAND_DUMP;</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (arguments.getSize() == 2) {</div>
<div class="line">      <span class="keywordflow">if</span> (arguments[0] == <span class="stringliteral">&quot;dump&quot;</span>) {</div>
<div class="line">        command = COMMAND_DUMP;</div>
<div class="line">        guid = arguments[1];</div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (arguments[0] == <span class="stringliteral">&quot;reset&quot;</span>) {</div>
<div class="line">        command = COMMAND_RESET;</div>
<div class="line">        guid = arguments[1];</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (arguments.getSize() == 3) {</div>
<div class="line">      <span class="keywordflow">if</span> (arguments[0] == <span class="stringliteral">&quot;registers&quot;</span>) {</div>
<div class="line">        command = COMMAND_REGISTER_SPACE;</div>
<div class="line">      }</div>
<div class="line">      <span class="comment">// firstAddress &lt;= arguments[1];</span></div>
<div class="line">      <span class="comment">// lastAddress &lt;= arguments[2];</span></div>
<div class="line">      firstAddress = IEEE1394::CSR_BASE_ADDRESS; <span class="comment">// 0xfffff0000000ULL</span></div>
<div class="line">      lastAddress = firstAddress + 0x1000;</div>
<div class="line">      <span class="keywordflow">if</span> ((firstAddress % 4 != 0) || (lastAddress % 4 != 0) || (firstAddress &gt; lastAddress)) {</div>
<div class="line">        command = COMMAND_ERROR;</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      command = COMMAND_HELP;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    EUI64 id;</div>
<div class="line">    <span class="keywordflow">if</span> (guid.isProper()) {</div>
<div class="line">      <span class="keywordflow">try</span> {</div>
<div class="line">        <span class="keywordtype">id</span> = EUI64(guid);</div>
<div class="line">      } <span class="keywordflow">catch</span> (...) {</div>
<div class="line">        command = COMMAND_ERROR;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">switch</span> (command) {</div>
<div class="line">    <span class="keywordflow">case</span> COMMAND_LIST_ADAPTERS:</div>
<div class="line">      listAdapters();</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> COMMAND_LIST_CAMERAS:</div>
<div class="line">      listCameras();</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> COMMAND_DUMP:</div>
<div class="line">      dump();</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> COMMAND_RESET:</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> COMMAND_REGISTER_SPACE:</div>
<div class="line">      dumpRegisterSpace(firstAddress, lastAddress);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> COMMAND_HELP:</div>
<div class="line">      fout &lt;&lt; MESSAGE(<span class="stringliteral">&quot;Usage: &quot;</span>) &lt;&lt; getFormalName() &lt;&lt; MESSAGE(<span class="stringliteral">&quot; [help|adapters|registers|dump|reset] [EUI-64]&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> COMMAND_ERROR:</div>
<div class="line">      <span class="comment">// fout has been flushed</span></div>
<div class="line">      ferr &lt;&lt; MESSAGE(<span class="stringliteral">&quot;ERROR: Invalid parameter(s)&quot;</span>) &lt;&lt; EOL</div>
<div class="line">           &lt;&lt; MESSAGE(<span class="stringliteral">&quot;For help: &quot;</span>) &lt;&lt; getFormalName() &lt;&lt; MESSAGE(<span class="stringliteral">&quot; help&quot;</span>) &lt;&lt; ENDL;</div>
<div class="line">      setExitCode(Application::EXIT_CODE_ERROR);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">APPLICATION_STUB(Camera1394Application);</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="anamespacegip_html_ae4332c394042e65826527a09616032d2"><div class="ttname"><a href="namespacegip.html#ae4332c394042e65826527a09616032d2">gip::YCbCrToRGB</a></div><div class="ttdeci">RGBPixel&lt; COMPONENT &gt; YCbCrToRGB(const YCbCrPixel&lt; COMPONENT &gt; &amp;pixel) noexcept</div><div class="ttdef"><b>Definition:</b> YCbCrPixel.h:148</div></div>
<div class="ttc" id="anamespacegip_html_af07bb1ceb47affe5d873cdb8e4b7241a"><div class="ttname"><a href="namespacegip.html#af07bb1ceb47affe5d873cdb8e4b7241a">gip::makeYCbCrPixel</a></div><div class="ttdeci">YCbCrPixel&lt; COMPONENT &gt; makeYCbCrPixel(COMPONENT luma, COMPONENT cb, COMPONENT cr) noexcept</div><div class="ttdoc">Creates an Y'CbCr pixel.</div><div class="ttdef"><b>Definition:</b> YCbCrPixel.h:104</div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"></address>
</body>
</html>
